"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.WalletClient = void 0;
const createEntryPayload_js_1 = require("./createEntryPayload.js");
class WalletClient {
    constructor({ wallet }) {
        Object.defineProperty(this, "wallet", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.wallet = wallet;
    }
    async submitTransaction(payload) {
        return await this.wallet.signAndSubmitTransaction({
            sender: this.wallet.account?.address ?? "",
            data: {
                ...payload,
                functionArguments: payload.functionArguments.map((arg) => {
                    if (Array.isArray(arg)) {
                        return arg.map((item) => item);
                    }
                    else if (typeof arg === 'object') {
                        throw new Error(`a value of struct type: ${arg} is not supported`);
                    }
                    else {
                        return arg;
                    }
                }),
            }
        });
    }
    useABI(abi) {
        return new Proxy({}, {
            get: (_, prop) => {
                const functionName = prop.toString();
                return (...args) => {
                    const payload = (0, createEntryPayload_js_1.createEntryPayload)(abi, {
                        function: functionName,
                        typeArguments: args[0].type_arguments,
                        functionArguments: args[0].arguments,
                    });
                    return this.submitTransaction(payload);
                };
            },
        });
    }
}
exports.WalletClient = WalletClient;
//# sourceMappingURL=WalletClient.js.map